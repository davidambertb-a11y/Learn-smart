<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Learn Smart</title>
<link rel="icon" href="https://img.icons8.com/fluency/48/student-male.png" type="image/png">

<!-- Firebase SDKs -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-app.js";
import { getDatabase, ref, push, onValue } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyCjNN3-ar92LXYHRUm4Aoze6b95W6D8blU",
  authDomain: "learn-smart-f1833.firebaseapp.com",
  databaseURL: "https://learn-smart-f1833-default-rtdb.firebaseio.com",
  projectId: "learn-smart-f1833",
  storageBucket: "learn-smart-f1833.appspot.com",
  messagingSenderId: "459907839429",
  appId: "1:459907839429:web:4a908af852923f02e207ac",
  measurementId: "G-2T6XZKWPYJ"
};

// Initialize Firebase
const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

window.addEventListener('DOMContentLoaded', () => {
  const form = document.querySelector('#admin form');
  const postsContainer = document.querySelector('#postsContainer');
  const searchInput = document.querySelector('#search input');

  let allPosts = [];

  // Submit post
  form.addEventListener('submit', (e) => {
    e.preventDefault();
    const title = form.querySelector('input').value.trim();
    const content = form.querySelector('textarea').value.trim();
    if(title && content){
      const postsRef = ref(db, 'posts');
      push(postsRef, {
        title: title,
        content: content,
        date: new Date().toLocaleString('en-NG', { timeZone: 'Africa/Lagos', dateStyle: 'medium', timeStyle: 'short' })
      });
      form.reset();
    }
  });

  // Display posts in real-time
  const postsRef = ref(db, 'posts');
  onValue(postsRef, (snapshot) => {
    allPosts = [];
    snapshot.forEach((childSnap) => {
      const post = childSnap.val();
      allPosts.push(post);
    });
    displayPosts(allPosts);
  });

  // Search filter
  searchInput.addEventListener('input', () => {
    const query = searchInput.value.toLowerCase();
    const filtered = allPosts.filter(p => 
      p.title.toLowerCase().includes(query) || 
      p.content.toLowerCase().includes(query)
    );
    displayPosts(filtered);
  });

  function displayPosts(posts){
    postsContainer.innerHTML = '';
    posts.reverse().forEach(post => {
      const div = document.createElement('div');
      div.classList.add('post');
      div.innerHTML = `<h3>${post.title}</h3><small>Posted on ${post.date}</small><p>${post.content}</p>`;
      postsContainer.appendChild(div);
    });
  }
});
</script>

<style>
body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin:0; padding:0; background:#f5f7fa; color:#222; line-height:1.6; }
a { text-decoration:none; color:inherit; }
h1,h2,h3 { margin:0; }
button { cursor:pointer; }

/* HEADER / NAV */
header {
  background: linear-gradient(90deg,#0066cc,#00c4ff);
  color:white; padding:1rem 1.5rem; display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; position:relative;
}
header h1 { font-size:1.8rem; font-weight:bold; text-shadow:2px 2px 5px rgba(0,0,0,0.2); }
nav { display:flex; gap:1rem; flex-wrap:wrap; }
nav a { color:white; font-weight:500; padding:0.5rem 1rem; border-radius:6px; transition:background 0.3s; }
nav a:hover { background:rgba(255,255,255,0.2); }

/* MOBILE MENU */
.menu-btn { display:none; font-size:2rem; background:none; border:none; color:white; }
.mobile-nav { display:none; flex-direction:column; gap:0.8rem; background:#0066cc; position:absolute; top:100%; right:1.5rem; padding:1rem; border-radius:8px; }
.mobile-nav a { padding:0.5rem 1rem; display:block; color:white; }

/* CONTAINER */
.container { width:95%; max-width:900px; margin:2rem auto; background:white; padding:1.5rem; border-radius:12px; box-shadow:0 4px 12px rgba(0,0,0,0.1); }

/* SEARCH BAR */
.search-box { display:flex; margin-bottom:1rem; }
.search-box input { flex:1; padding:0.7rem; border:1px solid #ccc; border-radius:8px 0 0 8px; outline:none; }
.search-box button { padding:0.7rem 1rem; border:none; background:#0066cc; color:white; font-weight:bold; border-radius:0 8px 8px 0; }

/* POSTS */
.post { border-bottom:1px solid #eee; padding:1rem 0; }
.post h3 { color:#0066cc; }
.post small { color:gray; }

/* FORMS */
form { margin-top:1.5rem; display:flex; flex-direction:column; gap:0.8rem; }
form input, form textarea { padding:0.8rem; border:1px solid #ccc; border-radius:8px; font-size:1rem; }
form button { padding:0.8rem; border:none; background:#00b894; color:white; font-weight:bold; border-radius:8px; transition: background 0.3s; }
form button:hover { background:#009874; }

/* FOOTER */
footer { text-align:center; padding:1rem; margin-top:2rem; background:#0066cc; color:white; font-size:0.9rem; }

/* RESPONSIVE */
@media(max-width:768px){
  nav{ display:none; }
  .menu-btn{ display:block; }
}
</style>
</head>
<body>
<header>
  <h1>Learn Smart</h1>
  <nav class="desktop-nav">
    <a href="#">Home</a>
    <a href="#search">Search Topic</a>
    <a href="#submit">Submit Topic</a>
    <a href="#about">About</a>
    <a href="https://wa.me/2347083701096" target="_blank">Contact</a>
  </nav>
  <button class="menu-btn" onclick="toggleMenu()">â‹®</button>
  <div class="mobile-nav" id="mobileNav">
    <a href="#">Home</a>
    <a href="#search">Search Topic</a>
    <a href="#submit">Submit Topic</a>
    <a href="#about">About</a>
    <a href="https://wa.me/2347083701096" target="_blank">Contact</a>
  </div>
</header>

<div class="container">
  <!-- SEARCH -->
  <section id="search">
    <h2>Search Topics</h2>
    <div class="search-box">
      <input type="text" placeholder="Search for a subject...">
      <button>Search</button>
    </div>
  </section>

  <!-- POSTS -->
  <section>
    <h2>Recent Topics</h2>
    <div id="postsContainer"></div>
  </section>

  <!-- SUBMIT TOPIC -->
  <section id="submit">
    <h2>Submit a Topic</h2>
    <p>Students can send their questions directly via WhatsApp. Click below:</p>
    <a href="https://wa.me/2347083701096" target="_blank"><button>Message on WhatsApp</button></a>
  </section>

  <!-- ADMIN POST FORM -->
  <section id="admin">
    <h2>Post Answer (Admin Only)</h2>
    <form>
      <input type="text" placeholder="Topic Title" required>
      <textarea rows="5" placeholder="Write your answer here..." required></textarea>
      <button type="submit">Publish</button>
    </form>
  </section>

  <!-- ABOUT -->
  <section id="about">
    <h2>About Learn Smart</h2>
    <p>
      Learn Smart is an academic platform created to help Nigerian university students 
      find answers and explanations on any subject. Students submit topics, and Learn Smart 
      provides detailed, professional answers in a clear and simple way.
    </p>
  </section>
</div>

<footer>
  &copy; 2025 Learn Smart | Empowering Nigerian Students with Knowledge
</footer>

<script>
function toggleMenu() {
  const menu = document.getElementById('mobileNav');
  if(menu.style.display === 'flex'){ menu.style.display='none'; }
  else{ menu.style.display='flex'; }
}
</script>
</body>
  </html>
